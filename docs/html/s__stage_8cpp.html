<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sassena: s_stage.cpp File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Sassena
   &#160;<span id="projectnumber">1.4.1</span>
   </div>
   <div id="projectbrief">Software for calculating X-ray and Neutron Scattering Intensities from Molecular Dynamics Trajectories using Massively Parrallel Computers</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">s_stage.cpp File Reference</div>  </div>
</div>
<div class="contents">

<p>This executable routine is used to utilize the parallel data staging capabilities of the software sassena.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="common_8hpp_source.html">common.hpp</a>&quot;</code><br/>
<code>#include &lt;fstream&gt;</code><br/>
<code>#include &lt;iostream&gt;</code><br/>
<code>#include &lt;map&gt;</code><br/>
<code>#include &lt;sstream&gt;</code><br/>
<code>#include &lt;string&gt;</code><br/>
<code>#include &lt;sys/time.h&gt;</code><br/>
<code>#include &lt;vector&gt;</code><br/>
<code>#include &lt;boost/asio.hpp&gt;</code><br/>
<code>#include &lt;boost/date_time.hpp&gt;</code><br/>
<code>#include &lt;boost/regex.hpp&gt;</code><br/>
<code>#include &lt;boost/accumulators/accumulators.hpp&gt;</code><br/>
<code>#include &lt;boost/accumulators/statistics.hpp&gt;</code><br/>
<code>#include &lt;boost/archive/text_oarchive.hpp&gt;</code><br/>
<code>#include &lt;boost/archive/text_iarchive.hpp&gt;</code><br/>
<code>#include &lt;boost/exception/all.hpp&gt;</code><br/>
<code>#include &lt;boost/filesystem.hpp&gt;</code><br/>
<code>#include &lt;boost/mpi.hpp&gt;</code><br/>
<code>#include &lt;boost/math/special_functions.hpp&gt;</code><br/>
<code>#include &lt;boost/serialization/complex.hpp&gt;</code><br/>
<code>#include &lt;boost/serialization/map.hpp&gt;</code><br/>
<code>#include &lt;boost/serialization/vector.hpp&gt;</code><br/>
<code>#include &quot;<a class="el" href="exceptions_8hpp_source.html">exceptions/exceptions.hpp</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="coor3d_8hpp_source.html">math/coor3d.hpp</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="data__stager_8hpp_source.html">stager/data_stager.hpp</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="control_8hpp_source.html">control.hpp</a>&quot;</code><br/>
<code>#include &quot;log.hpp&quot;</code><br/>
<code>#include &quot;<a class="el" href="performance__analyzer_8hpp_source.html">report/performance_analyzer.hpp</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="timer_8hpp_source.html">report/timer.hpp</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="wrapper_8hpp_source.html">mpi/wrapper.hpp</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sample_2sample_8hpp_source.html">sample/sample.hpp</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="services_8hpp_source.html">services.hpp</a>&quot;</code><br/>
<code>#include &quot;SassenaConfig.hpp&quot;</code><br/>
</div>
<p><a href="s__stage_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s__stage_8cpp.html#a0d07fdb703241f00ec96b4861dd3fd94">print_title</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s__stage_8cpp.html#acaf1dcea7c3c52a8f66f1f7f241f9912">print_description</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s__stage_8cpp.html#a87805e5743d457a9355b0e274dfda0c6">print_initialization</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s__stage_8cpp.html#a3d4ac207a4172e03ca998c9876fcd616">print_computation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s__stage_8cpp.html#af17b62f905601cff3ef5f4a625ad472c">print_analysis</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s__stage_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This executable routine is used to utilize the parallel data staging capabilities of the software sassena. </p>
<p>It sets the partition size to all available nodes and reads and write any trajectory data in parallel. Can be used to benchmark the IO capacities of the hardware or to rewrite trajectory data using the capabilities offered through sassena.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Benjamin Lindner &lt;<a href="mailto:ben@benlabs.net">ben@benlabs.net</a>&gt; </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>1.3.0 </dd></dl>
<dl class="copyright"><dt><b>Copyright:</b></dt><dd>GNU General Public License </dd></dl>

<p>Definition in file <a class="el" href="s__stage_8cpp_source.html">s_stage.cpp</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a><!-- doxytag: member="s_stage.cpp::main" ref="a0ddf1224851353fc92bfbff6f499fa97" args="(int argc, char *argv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="s__stage_8cpp_source.html#l00100">100</a> of file <a class="el" href="s__stage_8cpp_source.html">s_stage.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                {

    <span class="comment">//------------------------------------------//</span>
    <span class="comment">//</span>
    <span class="comment">// MPI Initialization</span>
    <span class="comment">//</span>
    <span class="comment">//------------------------------------------//</span>
    boost::mpi::environment env(argc, argv);
    boost::mpi::communicator world;

    <span class="comment">// The rank 0 node is responsible for the progress output and to inform the user</span>
    <span class="comment">// compute nodes should be silent all the time, except when errors occur.</span>
    <span class="comment">// In that case the size and the rank should be included into the error message in the following way:</span>

    <span class="comment">// make sure any singleton class exists:</span>
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>();
    <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>();
    <a class="code" href="class_warn.html#ab06e92f8140f8f482c2acd6362ccc466">Warn::Inst</a>();
    
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#ad2db12946acc1b6b40e805487cca9601">set_prefix</a>(boost::lexical_cast&lt;string&gt;(world.rank())+<span class="keywordtype">string</span>(<span class="stringliteral">&quot;.Info&gt;&gt;&quot;</span>));
    <a class="code" href="class_warn.html#ab06e92f8140f8f482c2acd6362ccc466">Warn::Inst</a>()-&gt;<a class="code" href="class_warn.html#a3c431813b8dc6a503c7c00ea7e8e9060">set_prefix</a>(boost::lexical_cast&lt;string&gt;(world.rank())+<span class="keywordtype">string</span>(<span class="stringliteral">&quot;.Warn&gt;&gt;&quot;</span>));
    <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#a8a1a92bd18acdfc2d87ca6eb8c13a08d">set_prefix</a>(boost::lexical_cast&lt;string&gt;(world.rank())+<span class="keywordtype">string</span>(<span class="stringliteral">&quot;.Err&gt;&gt;&quot;</span>));
    
    Params* params = Params::Inst();
    <a class="code" href="class_database.html" title="This singleton class is the root of a strong class hierarchy which implements a software wide databas...">Database</a>* database = <a class="code" href="class_database.html#a38f080e0e65850789ad4790b9ac38b01">Database::Inst</a>();

    <a class="code" href="class_sample.html" title="Managment class for structure and coordinates.">Sample</a> sample;
    
    <a class="code" href="class_timer.html" title="Basic Timer which provides a start/stop facility measure runtimes.">Timer</a> timer;
    timer.<a class="code" href="class_timer.html#ac736172e11e7d42d67904f57b07c6643">start</a>(<span class="stringliteral">&quot;total&quot;</span>);

    <span class="keywordflow">if</span> (world.rank()==0) {
        <a class="code" href="s__maketnx_8cpp.html#a0d07fdb703241f00ec96b4861dd3fd94">print_title</a>();
        <a class="code" href="s__maketnx_8cpp.html#acaf1dcea7c3c52a8f66f1f7f241f9912">print_description</a>();
    }

    <span class="keywordtype">bool</span> initstatus = <span class="keyword">true</span>;

    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="s__stage_8cpp.html#a87805e5743d457a9355b0e274dfda0c6">print_initialization</a>();
    <span class="keywordflow">if</span> (world.rank()==0) {
        
        <span class="keywordflow">try</span> {

            timer.<a class="code" href="class_timer.html#ac736172e11e7d42d67904f57b07c6643">start</a>(<span class="stringliteral">&quot;sample::setup&quot;</span>);
        
            params-&gt;init(argc,argv);
            database-&gt;<a class="code" href="class_database.html#a6a73637867ee3a2fc733ba13ad8ff7c2">init</a>();
        
            sample.<a class="code" href="class_sample.html#ab64af3a01ab5596ed9b341c31627c56c">init</a>();
        
            timer.<a class="code" href="class_timer.html#a79c776af18df0532d4b48645987623ca">stop</a>(<span class="stringliteral">&quot;sample::setup&quot;</span>);
        } <span class="keywordflow">catch</span> (<a class="code" href="classsassena_1_1terminate__request.html" title="Signal which should be caught in the main routine to allow a clean termination.">sassena::terminate_request</a> <span class="keyword">const</span>&amp; e) {
            <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;Hangup requested&quot;</span>);
            initstatus = <span class="keyword">false</span>;             
        } <span class="keywordflow">catch</span> (boost::exception <span class="keyword">const</span>&amp; e ) {
            initstatus = <span class="keyword">false</span>; 
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="stringliteral">&quot;Caught BOOST error, sending hangup to all nodes&quot;</span>);
            stringstream ss; ss &lt;&lt; diagnostic_information(e);
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Diagnotic information: &quot;</span>) + ss.str());
        } <span class="keywordflow">catch</span> (std::exception <span class="keyword">const</span>&amp; e) {
            initstatus = <span class="keyword">false</span>; 
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="stringliteral">&quot;Caught STD error, sending hangup to all nodes&quot;</span>);
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;what() : &quot;</span>) + e.what());
        } <span class="keywordflow">catch</span> (...) {
            initstatus = <span class="keyword">false</span>; 
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="stringliteral">&quot;Caught error: UNKNOWN sending hangup to all nodes&quot;</span>);
        }
    }
    
    broadcast(world,&amp;initstatus,1,0);               
    <span class="comment">// if something went wrong during initialization, exit now.</span>
    <span class="keywordflow">if</span> (!initstatus) {
        world.barrier();
        <span class="keywordflow">return</span> 0;
    }
            
    <span class="comment">//------------------------------------------//</span>
    <span class="comment">//</span>
    <span class="comment">// Communication of the sample</span>
    <span class="comment">// At this point it is ILLEGAL to change anything within the sample.</span>
    <span class="comment">//</span>
    <span class="comment">//------------------------------------------//</span>

    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;Exchanging sample, database &amp; params information with compute nodes... &quot;</span>);
    
    world.barrier();

    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;params... &quot;</span>);
    timer.<a class="code" href="class_timer.html#ac736172e11e7d42d67904f57b07c6643">start</a>(<span class="stringliteral">&quot;params::comm&quot;</span>);
    mpi::wrapper::broadcast_class&lt;Params&gt;(world,*params,0);
    world.barrier();
    timer.<a class="code" href="class_timer.html#a79c776af18df0532d4b48645987623ca">stop</a>(<span class="stringliteral">&quot;params::comm&quot;</span>);
    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;database... &quot;</span>);
    timer.<a class="code" href="class_timer.html#ac736172e11e7d42d67904f57b07c6643">start</a>(<span class="stringliteral">&quot;db::comm&quot;</span>);
    mpi::wrapper::broadcast_class&lt;Database&gt;(world,*database,0);
    world.barrier();
    timer.<a class="code" href="class_timer.html#a79c776af18df0532d4b48645987623ca">stop</a>(<span class="stringliteral">&quot;db::comm&quot;</span>);
    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;sample... &quot;</span>);
    timer.<a class="code" href="class_timer.html#ac736172e11e7d42d67904f57b07c6643">start</a>(<span class="stringliteral">&quot;sample::comm&quot;</span>);
    mpi::wrapper::broadcast_class&lt;Sample&gt;(world,sample,0);
    world.barrier();
    timer.<a class="code" href="class_timer.html#a79c776af18df0532d4b48645987623ca">stop</a>(<span class="stringliteral">&quot;sample::comm&quot;</span>);

    <span class="comment">//------------------------------------------//</span>
    <span class="comment">//</span>
    <span class="comment">// Scattering calculation</span>
    <span class="comment">//</span>
    <span class="comment">//------------------------------------------//</span>
        
    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;Setting up parallel environment...&quot;</span>); 

    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;Starting staging...&quot;</span>);    
    
    <span class="comment">// prepare sample</span>
    <span class="keywordtype">size_t</span> NF = sample.coordinate_sets.size();
    <span class="keywordtype">string</span> target = Params::Inst()-&gt;stager.target;
    <span class="keywordtype">size_t</span> NA = sample.atoms.selections[target]-&gt;size();
    {
        sample.coordinate_sets.set_selection(sample.atoms.selections[target]);
        sample.coordinate_sets.set_representation(<a class="code" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8ad0f64430e58c5010eddd5289ab519800">CARTESIAN</a>);        
    }

    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;stager.mode=&quot;</span>)+Params::Inst()-&gt;stager.mode);
    
    <span class="keywordflow">if</span> (Params::Inst()-&gt;stager.mode==<span class="stringliteral">&quot;frames&quot;</span>) {
        <a class="code" href="class_data_stager_by_frame.html" title="Loads coordinate data, performs frame decomposition of the trajectory data and places it efficiently ...">DataStagerByFrame</a> data_stager(sample,world,world,timer);
        <a class="code" href="common_8hpp.html#a9a40557f25ccea52898bc0dfd46fa62b">coor_t</a>* p_coordinates = data_stager.stage();
        <span class="keyword">delete</span> p_coordinates;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Params::Inst()-&gt;stager.mode==<span class="stringliteral">&quot;atoms&quot;</span>) {
        <a class="code" href="class_data_stager_by_atom.html" title="Loads coordinate data, performs atom decomposition of the trajectory data and places it efficiently i...">DataStagerByAtom</a> data_stager(sample,world,world,timer);
        <a class="code" href="common_8hpp.html#a9a40557f25ccea52898bc0dfd46fa62b">coor_t</a>* p_coordinates = data_stager.stage();
        <span class="keyword">delete</span> p_coordinates;        
    } <span class="keywordflow">else</span> {
        <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Staging mode not understood stager.mode=&quot;</span>)+Params::Inst()-&gt;stager.mode);
        <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Use &#39;frames&#39; or &#39;atoms&#39;&quot;</span>));
        <span class="keywordflow">throw</span>;
    }
    
    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;Staging finishe...&quot;</span>); 
    
    
    <span class="comment">// start computation tasks</span>

    world.barrier();

    <span class="keywordflow">if</span> (world.rank()==0) <a class="code" href="s__stage_8cpp.html#af17b62f905601cff3ef5f4a625ad472c">print_analysis</a>();
    
    <span class="keywordflow">if</span> (world.rank()==0) {
        <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Aggregating timing information for performance analysis...&quot;</span>));      
    }
    
    timer.<a class="code" href="class_timer.html#a79c776af18df0532d4b48645987623ca">stop</a>(<span class="stringliteral">&quot;total&quot;</span>);
    
    std::map&lt;boost::thread::id,Timer&gt; performance_timer;
    performance_timer[boost::this_thread::get_id()]=timer;
    <a class="code" href="class_performance_analyzer.html" title="Analyzes the information from a set of timers provided at construction and prepares a formatted outpu...">PerformanceAnalyzer</a> perfanal(world,performance_timer); <span class="comment">// collect timing information from everybody.</span>
        
    <span class="keywordflow">if</span> (world.rank()==0) {
        perfanal.report();
        perfanal.report_relative(timer.<a class="code" href="class_timer.html#a321d0d97879e5b9e2019a15f8ee05075">sum</a>(<span class="stringliteral">&quot;total&quot;</span>)*world.size());
        <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Total runtime (s): &quot;</span>)+boost::lexical_cast&lt;string&gt;(timer.<a class="code" href="class_timer.html#a321d0d97879e5b9e2019a15f8ee05075">sum</a>(<span class="stringliteral">&quot;total&quot;</span>)));
        <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;Successfully finished... Have a nice day!&quot;</span>);
    }

    <span class="comment">//------------------------------------------//</span>
    <span class="comment">//</span>
    <span class="comment">// Finished</span>
    <span class="comment">//</span>
    <span class="comment">//------------------------------------------//  </span>

    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af17b62f905601cff3ef5f4a625ad472c"></a><!-- doxytag: member="s_stage.cpp::print_analysis" ref="af17b62f905601cff3ef5f4a625ad472c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_analysis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="s__stage_8cpp_source.html#l00094">94</a> of file <a class="el" href="s__stage_8cpp_source.html">s_stage.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                      {
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.....................R.U.N...A.N.A.L.Y.S.I.S.....................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);   
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3d4ac207a4172e03ca998c9876fcd616"></a><!-- doxytag: member="s_stage.cpp::print_computation" ref="a3d4ac207a4172e03ca998c9876fcd616" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_computation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="s__stage_8cpp_source.html#l00088">88</a> of file <a class="el" href="s__stage_8cpp_source.html">s_stage.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                         {
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;......................C.O.M.P.U.T.A.T.I.O.N......................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);   
}
</pre></div>
</div>
</div>
<a class="anchor" id="acaf1dcea7c3c52a8f66f1f7f241f9912"></a><!-- doxytag: member="s_stage.cpp::print_description" ref="acaf1dcea7c3c52a8f66f1f7f241f9912" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_description </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="s__stage_8cpp_source.html#l00069">69</a> of file <a class="el" href="s__stage_8cpp_source.html">s_stage.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                         {
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;......................D.E.S.C.R.I.P.T.I.O.N......................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);   

    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;This binary stages the trajectory data on a parallel partition&quot;</span>);  
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;It may be used to test I/O and to generate post-processed&quot;</span>);   
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;trajectories by setting stager.dump=true&quot;</span>);        
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);   
}
</pre></div>
</div>
</div>
<a class="anchor" id="a87805e5743d457a9355b0e274dfda0c6"></a><!-- doxytag: member="s_stage.cpp::print_initialization" ref="a87805e5743d457a9355b0e274dfda0c6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_initialization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="s__stage_8cpp_source.html#l00082">82</a> of file <a class="el" href="s__stage_8cpp_source.html">s_stage.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                            {
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;...................I.N.I.T.I.A.L.I.Z.A.T.I.O.N...................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.................................................................&quot;</span>);   
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0d07fdb703241f00ec96b4861dd3fd94"></a><!-- doxytag: member="s_stage.cpp::print_title" ref="a0d07fdb703241f00ec96b4861dd3fd94" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_title </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="s__stage_8cpp_source.html#l00053">53</a> of file <a class="el" href="s__stage_8cpp_source.html">s_stage.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                   {
    
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;This software is being developed by Benjamin Lindner.                    &quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;For help, suggestions or correspondense use:                             &quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;ben@benlabs.net, Benjamin Lindner (Main Developer, Impl. &amp; Maintenance)  &quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;franc@cmm.ki.si, Franci Merzel (Methodology)                             &quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;For publications include the following references:                       &quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.........................................................................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;1. Sassena - Scattering Calculations on Parallel Computers               &quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;   to be published                                                       &quot;</span>);       
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;.........................................................................&quot;</span>);
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Version Information: &quot;</span>) + <span class="keywordtype">string</span>(Sassena_VERSIONSTRING));
    <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="stringliteral">&quot;&quot;</span>);

}
</pre></div>
</div>
</div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 7 2012 20:58:53 for Sassena by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
