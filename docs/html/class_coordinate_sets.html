<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sassena: CoordinateSets Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Sassena
   &#160;<span id="projectnumber">1.4.1</span>
   </div>
   <div id="projectbrief">Software for calculating X-ray and Neutron Scattering Intensities from Molecular Dynamics Trajectories using Massively Parrallel Computers</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">CoordinateSets Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="CoordinateSets" -->
<p>Management class for coordinate sets.  
 <a href="class_coordinate_sets.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>&gt;</code></p>

<p><a href="class_coordinate_sets-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a9a88dbd44b3e3b7a4dc3670759049397">CoordinateSets</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a5408b76991a152f4ea54070d244cacc8">~CoordinateSets</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_coordinate_set.html">CoordinateSet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#ac85efa8a6d7438a07ce3d41a8eb1100f">load</a> (size_t frame)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a687990ee78dae83628564f22250836d1">set_selection</a> (<a class="el" href="class_i_atomselection.html">IAtomselection</a> *selection)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a4fa6b50f55869ceebaf8ab866b3acc1a">set_atoms</a> (<a class="el" href="class_atoms.html">Atoms</a> &amp;atoms)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a8957228f5097d59409164c46d0cb012a">set_representation</a> (<a class="el" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8">CoordinateRepresentation</a> representation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8">CoordinateRepresentation</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#ae55df7ae5c396c6ce95ad2af10ca5d9d">get_representation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a570a0ff92758bddaacaad462b53462b5">add_prealignment</a> (<a class="el" href="class_coordinate_set_alignment.html">CoordinateSetAlignment</a> alignment)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#ab45fce4efc815129ce72684d75b35142">add_postalignment</a> (<a class="el" href="class_coordinate_set_alignment.html">CoordinateSetAlignment</a> alignment)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a9e0021d7721820394fef2d4ca44895bf">write_xyz</a> (std::string filename)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_i_atomselection.html">IAtomselection</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a991089c8d71d966ab3c455f993fb0fe0">get_selection</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a14bf97cc5250945ef9823972b879a314">init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#ac7b9aefaa1506fb01916e38b18e851f6">size</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class Archive &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a6d3e45b120bc3fd1fb47a7d3ba7a8985">serialize</a> (Archive &amp;ar, const unsigned int version)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair<br class="typebreak"/>
&lt; std::string, <a class="el" href="class_motion_walker.html">MotionWalker</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">m_motion_walkers</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector<br class="typebreak"/>
&lt; <a class="el" href="class_coordinate_set_alignment.html">CoordinateSetAlignment</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">m_prealignments</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector<br class="typebreak"/>
&lt; <a class="el" href="class_coordinate_set_alignment.html">CoordinateSetAlignment</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">m_postalignments</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_frames.html">Frames</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a3a20f359374d6b852b0f319ff612f871">frames</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_atoms.html">Atoms</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_i_atomselection.html">IAtomselection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#a673223c4767d42faafcf2cf234aa80ed">p_selection</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8">CoordinateRepresentation</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#ab48f14ec44b28aadfb6729ba5dda7d4c">m_representation</a></td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coordinate_sets.html#ac98d07dd8f7b70e16ccb9a01abf56b9c">boost::serialization::access</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Management class for coordinate sets. </p>

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00057">57</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9a88dbd44b3e3b7a4dc3670759049397"></a><!-- doxytag: member="CoordinateSets::CoordinateSets" ref="a9a88dbd44b3e3b7a4dc3670759049397" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CoordinateSets::CoordinateSets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00033">33</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                               {

}
</pre></div>
</div>
</div>
<a class="anchor" id="a5408b76991a152f4ea54070d244cacc8"></a><!-- doxytag: member="CoordinateSets::~CoordinateSets" ref="a5408b76991a152f4ea54070d244cacc8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CoordinateSets::~CoordinateSets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00037">37</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                {
    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">m_motion_walkers</a>.size(); ++i)
    {
        <span class="keyword">delete</span> <a class="code" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">m_motion_walkers</a>[i].second;
    }
    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">m_prealignments</a>.size(); ++i)
    {
        <span class="keywordflow">if</span> (<a class="code" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">m_prealignments</a>[i].p_reference!=NULL) {
            <span class="keyword">delete</span> <a class="code" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">m_prealignments</a>[i].p_reference;
        }
    }
    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">m_postalignments</a>.size(); ++i)
    {
        <span class="keywordflow">if</span> (<a class="code" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">m_postalignments</a>[i].p_reference!=NULL) {
            <span class="keyword">delete</span> <a class="code" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">m_postalignments</a>[i].p_reference;
        }
    }
    
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab45fce4efc815129ce72684d75b35142"></a><!-- doxytag: member="CoordinateSets::add_postalignment" ref="ab45fce4efc815129ce72684d75b35142" args="(CoordinateSetAlignment alignment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoordinateSets::add_postalignment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_coordinate_set_alignment.html">CoordinateSetAlignment</a>&#160;</td>
          <td class="paramname"><em>alignment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a570a0ff92758bddaacaad462b53462b5"></a><!-- doxytag: member="CoordinateSets::add_prealignment" ref="a570a0ff92758bddaacaad462b53462b5" args="(CoordinateSetAlignment alignment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoordinateSets::add_prealignment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_coordinate_set_alignment.html">CoordinateSetAlignment</a>&#160;</td>
          <td class="paramname"><em>alignment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae55df7ae5c396c6ce95ad2af10ca5d9d"></a><!-- doxytag: member="CoordinateSets::get_representation" ref="ae55df7ae5c396c6ce95ad2af10ca5d9d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8">CoordinateRepresentation</a> CoordinateSets::get_representation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00191">191</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                            {
    <span class="keywordflow">return</span> <a class="code" href="class_coordinate_sets.html#ab48f14ec44b28aadfb6729ba5dda7d4c">m_representation</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a991089c8d71d966ab3c455f993fb0fe0"></a><!-- doxytag: member="CoordinateSets::get_selection" ref="a991089c8d71d966ab3c455f993fb0fe0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_i_atomselection.html">IAtomselection</a> &amp; CoordinateSets::get_selection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00312">312</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                              {
    <span class="keywordflow">return</span> *<a class="code" href="class_coordinate_sets.html#a673223c4767d42faafcf2cf234aa80ed">p_selection</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a14bf97cc5250945ef9823972b879a314"></a><!-- doxytag: member="CoordinateSets::init" ref="a14bf97cc5250945ef9823972b879a314" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoordinateSets::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00057">57</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                          {

    <span class="comment">// read in frame information</span>
    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; Params::Inst()-&gt;sample.framesets.size(); ++i)
    {
        <a class="code" href="class_sample_frameset_parameters.html" title="Section which defines a single trajectory file entry.">SampleFramesetParameters</a>&amp; f = Params::Inst()-&gt;sample.framesets[i];
        <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Reading frames from: &quot;</span>)+f.<a class="code" href="class_sample_frameset_parameters.html#a439b2f414870b58ff1451e6b9397c8eb">filename</a>);
        <span class="keywordflow">if</span> (f.<a class="code" href="class_sample_frameset_parameters.html#a6a9bed6ca690d7201db8cbf89604207f">clones</a>!=1) {
            <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Cloning frameset &quot;</span>)+boost::lexical_cast&lt;string&gt;(f.<a class="code" href="class_sample_frameset_parameters.html#a6a9bed6ca690d7201db8cbf89604207f">clones</a>)+<span class="keywordtype">string</span>(<span class="stringliteral">&quot; times&quot;</span>));
        }
        <span class="keywordtype">size_t</span> nof = 0;
        nof += <a class="code" href="class_coordinate_sets.html#a3a20f359374d6b852b0f319ff612f871">frames</a>.<a class="code" href="class_frames.html#a34f811a97ad3200ec88f0f5ecd0e9fd0">add_frameset</a>(f.<a class="code" href="class_sample_frameset_parameters.html#a439b2f414870b58ff1451e6b9397c8eb">filename</a>,f.<a class="code" href="class_sample_frameset_parameters.html#a682edca19f4a0ea2c93cef321a367c80">type</a>,f.<a class="code" href="class_sample_frameset_parameters.html#ae4845b74a53767b3df7859df50b808eb">first</a>,f.<a class="code" href="class_sample_frameset_parameters.html#a13bb94676a306765a0dc67605fd746f4">last</a>,f.<a class="code" href="class_sample_frameset_parameters.html#a20db6958425204c9b0677ff957f4db0b">last_set</a>,f.<a class="code" href="class_sample_frameset_parameters.html#abf3c976f999ceacd275e83884bc16c3d">stride</a>,f.<a class="code" href="class_sample_frameset_parameters.html#a5656d8a6c7de2960d7951fcf5dc96bd9">index</a>,f.<a class="code" href="class_sample_frameset_parameters.html#a55c4dac9733e49f1e603d037e1f9081b">index_default</a>,f.<a class="code" href="class_sample_frameset_parameters.html#a6a9bed6ca690d7201db8cbf89604207f">clones</a>);          
        <a class="code" href="class_info.html#a01be1a7ac2628d0de97d1a22e9a3e04f">Info::Inst</a>()-&gt;<a class="code" href="class_info.html#a07d6767d64628b10ef86d209964b32aa">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Found &quot;</span>)+boost::lexical_cast&lt;string&gt;(nof)+<span class="keywordtype">string</span>(<span class="stringliteral">&quot; frames&quot;</span>));           
    }
    
    <span class="comment">// construct a helper for the motions:</span>
    <span class="keywordflow">if</span> (Params::Inst()-&gt;sample.motions.size()&gt;0) {
        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; Params::Inst()-&gt;sample.motions.size(); ++i)
        {
            <a class="code" href="class_sample_motion_parameters.html" title="Section which defines artificial motions.">SampleMotionParameters</a>&amp; motion = Params::Inst()-&gt;sample.motions[i];
            <a class="code" href="class_motion_walker.html" title="Interface for an artficial motion generator.">MotionWalker</a>* p_mw = NULL;

            <span class="keywordflow">if</span> (motion.<a class="code" href="class_sample_motion_parameters.html#ac350aa3023ba34f3cb2e65c15efe932a">type</a>==<span class="stringliteral">&quot;linear&quot;</span>) {
                p_mw = <span class="keyword">new</span> <a class="code" href="class_linear_motion_walker.html" title="Generates a linear motion.">LinearMotionWalker</a>(motion.<a class="code" href="class_sample_motion_parameters.html#ab4aa0ab50459e7367568d30ac394da32">displace</a>,motion.<a class="code" href="class_sample_motion_parameters.html#ad7dd05dbff0df4728d08416f996cf51a">sampling</a>,motion.<a class="code" href="class_sample_motion_parameters.html#abf70e96d86bcd29e08d14d46634be72d">direction</a>);
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motion.<a class="code" href="class_sample_motion_parameters.html#ac350aa3023ba34f3cb2e65c15efe932a">type</a>==<span class="stringliteral">&quot;fixed&quot;</span>) {
                p_mw = <span class="keyword">new</span> <a class="code" href="class_fixed_motion_walker.html" title="No motion.">FixedMotionWalker</a>(motion.<a class="code" href="class_sample_motion_parameters.html#ab4aa0ab50459e7367568d30ac394da32">displace</a>,motion.<a class="code" href="class_sample_motion_parameters.html#abf70e96d86bcd29e08d14d46634be72d">direction</a>);
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motion.<a class="code" href="class_sample_motion_parameters.html#ac350aa3023ba34f3cb2e65c15efe932a">type</a>==<span class="stringliteral">&quot;oscillation&quot;</span>) {
                p_mw = <span class="keyword">new</span> <a class="code" href="class_oscillation_motion_walker.html" title="Sinoidal Oscillation with amplitude and frequency.">OscillationMotionWalker</a>(motion.<a class="code" href="class_sample_motion_parameters.html#ab4aa0ab50459e7367568d30ac394da32">displace</a>,motion.<a class="code" href="class_sample_motion_parameters.html#aba8cc1ba9dbc30464f619e161ece0044">frequency</a>,motion.<a class="code" href="class_sample_motion_parameters.html#ad7dd05dbff0df4728d08416f996cf51a">sampling</a>, motion.<a class="code" href="class_sample_motion_parameters.html#abf70e96d86bcd29e08d14d46634be72d">direction</a>);
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motion.<a class="code" href="class_sample_motion_parameters.html#ac350aa3023ba34f3cb2e65c15efe932a">type</a>==<span class="stringliteral">&quot;randomwalk&quot;</span>) {
                p_mw = <span class="keyword">new</span> <a class="code" href="class_random_motion_walker.html" title="Simple random motion in 3D with a constant step size.">RandomMotionWalker</a>(motion.<a class="code" href="class_sample_motion_parameters.html#ab4aa0ab50459e7367568d30ac394da32">displace</a>,motion.<a class="code" href="class_sample_motion_parameters.html#a04377fbc8cb8759a01a26b3b2cf23afb">seed</a>,motion.<a class="code" href="class_sample_motion_parameters.html#ad7dd05dbff0df4728d08416f996cf51a">sampling</a>, motion.<a class="code" href="class_sample_motion_parameters.html#abf70e96d86bcd29e08d14d46634be72d">direction</a>);               
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motion.<a class="code" href="class_sample_motion_parameters.html#ac350aa3023ba34f3cb2e65c15efe932a">type</a>==<span class="stringliteral">&quot;brownian&quot;</span>) {
                p_mw = <span class="keyword">new</span> <a class="code" href="class_brownian_motion_walker.html" title="Brownian motion in 3D which draws the step size from a gaussian distribution for the given mean (disp...">BrownianMotionWalker</a>(motion.<a class="code" href="class_sample_motion_parameters.html#ab4aa0ab50459e7367568d30ac394da32">displace</a>,motion.<a class="code" href="class_sample_motion_parameters.html#a04377fbc8cb8759a01a26b3b2cf23afb">seed</a>,motion.<a class="code" href="class_sample_motion_parameters.html#ad7dd05dbff0df4728d08416f996cf51a">sampling</a>, motion.<a class="code" href="class_sample_motion_parameters.html#abf70e96d86bcd29e08d14d46634be72d">direction</a>);             
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motion.<a class="code" href="class_sample_motion_parameters.html#ac350aa3023ba34f3cb2e65c15efe932a">type</a>==<span class="stringliteral">&quot;localbrownian&quot;</span>) {
                p_mw = <span class="keyword">new</span> <a class="code" href="class_local_brownian_motion_walker.html" title="Brownian motion in 3D which draws the step size from a gaussian distribution for the given mean (disp...">LocalBrownianMotionWalker</a>(motion.<a class="code" href="class_sample_motion_parameters.html#a2ef14a6c5ba1dc751ea1a951f2b67bee">radius</a>,motion.<a class="code" href="class_sample_motion_parameters.html#ab4aa0ab50459e7367568d30ac394da32">displace</a>,motion.<a class="code" href="class_sample_motion_parameters.html#a04377fbc8cb8759a01a26b3b2cf23afb">seed</a>,motion.<a class="code" href="class_sample_motion_parameters.html#ad7dd05dbff0df4728d08416f996cf51a">sampling</a>, motion.<a class="code" href="class_sample_motion_parameters.html#abf70e96d86bcd29e08d14d46634be72d">direction</a>);                              
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motion.<a class="code" href="class_sample_motion_parameters.html#ac350aa3023ba34f3cb2e65c15efe932a">type</a>==<span class="stringliteral">&quot;none&quot;</span>) {
                p_mw = NULL;
            }
            <span class="keywordflow">else</span> {
                <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="stringliteral">&quot;Motion type not understood&quot;</span>);
                <span class="keywordflow">throw</span>;
            }
            
            
            <span class="keywordflow">if</span> (p_mw!=NULL) {
                <a class="code" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">m_motion_walkers</a>.push_back(make_pair&lt;string,MotionWalker*&gt;(motion.<a class="code" href="class_sample_motion_parameters.html#a04d0cb69fc34baea81336108dc629ad1">selection</a>,p_mw));             
            }
        }
    }
    
    <span class="comment">// construct a helper for the alignments:</span>
    <span class="keywordflow">if</span> (Params::Inst()-&gt;sample.alignments.size()&gt;0) {
        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; Params::Inst()-&gt;sample.alignments.size(); ++i)
        {
            <a class="code" href="class_coordinate_set_alignment.html" title="Stores alignment information which is used during the loading to perform transformation of the origin...">CoordinateSetAlignment</a> a;
            
            std::string type = Params::Inst()-&gt;sample.alignments[i].<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>;
            std::string order = Params::Inst()-&gt;sample.alignments[i].order;
            std::string selection = Params::Inst()-&gt;sample.alignments[i].selection;
            std::string rtype = Params::Inst()-&gt;sample.alignments[i].reference.type;
            std::string rselection = Params::Inst()-&gt;sample.alignments[i].reference.selection;    
            
            a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a> = type;
            a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a> = selection;
            a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a> = rselection;
            a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a> = NULL;

            <span class="comment">// read and store reference now</span>
            <span class="keywordflow">if</span> (rtype==<span class="stringliteral">&quot;frame&quot;</span>) {
                <span class="keywordtype">size_t</span> framenumber = Params::Inst()-&gt;sample.alignments[i].reference.frame;
                <span class="keywordflow">if</span> (framenumber&gt;=this-&gt;<a class="code" href="class_coordinate_sets.html#ac7b9aefaa1506fb01916e38b18e851f6">size</a>()) {
                    <a class="code" href="class_warn.html#ab06e92f8140f8f482c2acd6362ccc466">Warn::Inst</a>()-&gt;<a class="code" href="class_warn.html#adb03d0302a3ffad4267e4e13c659941b">write</a>(<span class="stringliteral">&quot;reference frame number in alignment larger than size of frameset. Setting to last frame!&quot;</span>);
                    framenumber = this-&gt;<a class="code" href="class_coordinate_sets.html#ac7b9aefaa1506fb01916e38b18e851f6">size</a>()-1;
                }
                <a class="code" href="class_frame.html" title="Stores Frame information and resembles the trajectory data.">Frame</a> frame = <a class="code" href="class_coordinate_sets.html#a3a20f359374d6b852b0f319ff612f871">frames</a>.<a class="code" href="class_frames.html#abbbbbdcb62d0ea0cfa03ab3fba204cef">load</a>(framenumber);
                a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a> = <span class="keyword">new</span> <a class="code" href="class_cartesian_coordinate_set.html" title="Specialized coordinate set which provides addtional functions for translation and rotation...">CartesianCoordinateSet</a>(frame,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtype==<span class="stringliteral">&quot;file&quot;</span>) {
                std::string file = Params::Inst()-&gt;sample.alignments[i].reference.file;
                std::string format = Params::Inst()-&gt;sample.alignments[i].reference.format;
                <span class="keywordtype">size_t</span> framenumber = Params::Inst()-&gt;sample.alignments[i].reference.frame;
                <span class="keywordflow">if</span> (format==<span class="stringliteral">&quot;pdb&quot;</span>) {
                    <a class="code" href="class_p_d_b_frameset.html" title="Frameset class for the PDB trajectory file format, based on VMD animate write.">PDBFrameset</a> fs(file,0);
                    fs.generate_index();
                    <span class="keywordflow">if</span> (framenumber&gt;=fs.number_of_frames) {
                        <a class="code" href="class_warn.html#ab06e92f8140f8f482c2acd6362ccc466">Warn::Inst</a>()-&gt;<a class="code" href="class_warn.html#adb03d0302a3ffad4267e4e13c659941b">write</a>(<span class="stringliteral">&quot;reference frame number in alignment larger than size of frameset. Setting to last frame!&quot;</span>);
                        framenumber = fs.number_of_frames-1;
                    }
                    <a class="code" href="class_frame.html" title="Stores Frame information and resembles the trajectory data.">Frame</a> cf;       
                    fs.read_frame(framenumber,cf);
                    a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a> = <span class="keyword">new</span> <a class="code" href="class_cartesian_coordinate_set.html" title="Specialized coordinate set which provides addtional functions for translation and rotation...">CartesianCoordinateSet</a>(cf,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
                } <span class="keywordflow">else</span> {
                    <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;File format for alignment reference not understood, format=&quot;</span>) + format);
                    <span class="keywordflow">throw</span>;
                }
            } <span class="keywordflow">else</span> {
                <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Reference type not understood:&quot;</span>)+rtype );
                <span class="keywordflow">throw</span>;
            }
            
            <span class="keywordflow">if</span> (order==<span class="stringliteral">&quot;pre&quot;</span>) {
                <a class="code" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">m_prealignments</a>.push_back(a);
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order==<span class="stringliteral">&quot;post&quot;</span>) {
                <a class="code" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">m_postalignments</a>.push_back(a);                
            } <span class="keywordflow">else</span> {
                <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="stringliteral">&quot;Ordering of alignment not understood. Must be pre or post.&quot;</span>);
                <span class="keywordflow">throw</span>;
            }
        }
    }   
    
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac85efa8a6d7438a07ce3d41a8eb1100f"></a><!-- doxytag: member="CoordinateSets::load" ref="ac85efa8a6d7438a07ce3d41a8eb1100f" args="(size_t frame)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_coordinate_set.html">CoordinateSet</a> * CoordinateSets::load </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00199">199</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                      {
    
    <a class="code" href="class_frame.html" title="Stores Frame information and resembles the trajectory data.">Frame</a> frame = <a class="code" href="class_coordinate_sets.html#a3a20f359374d6b852b0f319ff612f871">frames</a>.<a class="code" href="class_frames.html#abbbbbdcb62d0ea0cfa03ab3fba204cef">load</a>(framenumber);
    <a class="code" href="class_cartesian_coordinate_set.html" title="Specialized coordinate set which provides addtional functions for translation and rotation...">CartesianCoordinateSet</a> cset(frame,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>]);
    <span class="keywordflow">if</span> ( frame.<a class="code" href="class_frame.html#a10a9ccdbc92e81bfe14563cd46ae8177">x</a>.size() != <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>]-&gt;size() ) {
        <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Wrong number of atoms, frame:&quot;</span>)+boost::lexical_cast&lt;string&gt;(framenumber));
        <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Atoms in Frame: &quot;</span>)+boost::lexical_cast&lt;string&gt;(frame.<a class="code" href="class_frame.html#a10a9ccdbc92e81bfe14563cd46ae8177">x</a>.size()));
        <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Atoms in Selection: &quot;</span>)+boost::lexical_cast&lt;string&gt;(<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>]-&gt;size()));
        <span class="keywordflow">throw</span>;
    }

    <span class="comment">// align here</span>
    <span class="comment">// m_prealignmentvectors[framenumber].clear();</span>
    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">m_prealignments</a>.size(); ++i)
    {
        <a class="code" href="class_coordinate_set_alignment.html" title="Stores alignment information which is used during the loading to perform transformation of the origin...">CoordinateSetAlignment</a>&amp; a = <a class="code" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">m_prealignments</a>[i];
        <span class="keywordflow">if</span> (a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>==<span class="stringliteral">&quot;center&quot;</span>) {
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> origin = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            cset.translate(-1.0*origin,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>], <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>]);
            <span class="comment">// m_prealignmentvectors[framenumber].push_back(-1.0*origin);</span>
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>==<span class="stringliteral">&quot;fittrans&quot;</span>) {
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> ref = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,*(a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a>),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> pos = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            cset.translate(ref-pos,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>], <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>]);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>==<span class="stringliteral">&quot;fitrottrans&quot;</span>) {
            <a class="code" href="class_fit.html" title="Operational class which takes performs a least squares fit on a structure with a target.">Fit</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>],*(a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a>),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);            
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>==<span class="stringliteral">&quot;fitrot&quot;</span>) {
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> ref = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,*(a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a>),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> pos = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            <a class="code" href="class_fit.html" title="Operational class which takes performs a least squares fit on a structure with a target.">Fit</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>],*(a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a>),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);            
            <span class="comment">// fit moves the center of mass, for rotational alignment only we have to correct the center of mass</span>
            cset.translate(pos,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>], <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>]);
        } <span class="keywordflow">else</span> {
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Fitting routine not understood: &quot;</span>)+a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>);
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Use either of: center , fittrans , fitrottrans, fitrot&quot;</span>));
            <span class="keywordflow">throw</span>;
        }
    }
        
    <span class="comment">// apply motions, operate in cartesian space</span>
    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">m_motion_walkers</a>.size(); ++i)
    {
        <span class="keywordtype">string</span> sel = <a class="code" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">m_motion_walkers</a>[i].first;
        <a class="code" href="class_motion_walker.html" title="Interface for an artficial motion generator.">MotionWalker</a>* p_mw = <a class="code" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">m_motion_walkers</a>[i].second;

        cset.translate(p_mw-&gt;<a class="code" href="class_motion_walker.html#a1d852129d905b29566b0b0f20e074377">translation</a>(framenumber),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>], <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[sel]);                     
    }       

    <span class="comment">// align here</span>
    <span class="comment">// m_postalignmentvectors[framenumber].clear();</span>
    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">m_postalignments</a>.size(); ++i)
    {
        <a class="code" href="class_coordinate_set_alignment.html" title="Stores alignment information which is used during the loading to perform transformation of the origin...">CoordinateSetAlignment</a>&amp; a = <a class="code" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">m_postalignments</a>[i];
        <span class="keywordflow">if</span> (a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>==<span class="stringliteral">&quot;center&quot;</span>) {
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> origin = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            cset.translate(-1.0*origin,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>], <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>]);
            <span class="comment">// m_prealignmentvectors[framenumber].push_back(-1.0*origin);</span>
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>==<span class="stringliteral">&quot;fittrans&quot;</span>) {
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> ref = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,*(a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a>),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> pos = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            cset.translate(ref-pos,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>], <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>]);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>==<span class="stringliteral">&quot;fitrottrans&quot;</span>) {
            <a class="code" href="class_fit.html" title="Operational class which takes performs a least squares fit on a structure with a target.">Fit</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>],*(a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a>),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);            
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>==<span class="stringliteral">&quot;fitrot&quot;</span>) {
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> ref = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,*(a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a>),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            <a class="code" href="class_cartesian_coor3_d.html" title="Type class which represents coordinates in cartesian space.">CartesianCoor3D</a> pos = <a class="code" href="class_center_of_mass.html" title="Helper class which takes Atoms and a Coordinate set and returns a cartesian coordinate.">CenterOfMass</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);
            <a class="code" href="class_fit.html" title="Operational class which takes performs a least squares fit on a structure with a target.">Fit</a>(*<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>,cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>],*(a.<a class="code" href="class_coordinate_set_alignment.html#a0e62dbdd339359462dbfa19a9f93fe2e">p_reference</a>),<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a8da3963df927c8deea169ee6f6924a23">reference_selection</a>]);            
            <span class="comment">// fit moves the center of mass, for rotational alignment only we have to correct the center of mass</span>
            cset.translate(pos,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>], <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[a.<a class="code" href="class_coordinate_set_alignment.html#a1dbce854a669f63dcd5debd8f35dd804">selection</a>]);
        } <span class="keywordflow">else</span> {
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Fitting routine not understood: &quot;</span>)+a.<a class="code" href="class_coordinate_set_alignment.html#ad1bc789a7f11cff5f4e4332bc970e850">type</a>);
            <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Use either of: center , fittrans , fitrottrans, fitrot&quot;</span>));
            <span class="keywordflow">throw</span>;
        }

    }    
    
    <span class="comment">// reduce the coordinate set to the target selection</span>
    <a class="code" href="class_cartesian_coordinate_set.html" title="Specialized coordinate set which provides addtional functions for translation and rotation...">CartesianCoordinateSet</a>* pcset_reduced = <span class="keyword">new</span> <a class="code" href="class_cartesian_coordinate_set.html" title="Specialized coordinate set which provides addtional functions for translation and rotation...">CartesianCoordinateSet</a>(cset,<a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a>-&gt;<a class="code" href="class_atoms.html#a714432625b04d6000a9c373b900d5a06">selections</a>[<span class="stringliteral">&quot;system&quot;</span>],<a class="code" href="class_coordinate_sets.html#a673223c4767d42faafcf2cf234aa80ed">p_selection</a>);
    
    <span class="comment">// convert to the current representation</span>
    <span class="keywordflow">if</span> (<a class="code" href="class_coordinate_sets.html#ab48f14ec44b28aadfb6729ba5dda7d4c">m_representation</a>==<a class="code" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8ad0f64430e58c5010eddd5289ab519800">CARTESIAN</a>) {
        <span class="keywordflow">return</span> pcset_reduced;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_coordinate_sets.html#ab48f14ec44b28aadfb6729ba5dda7d4c">m_representation</a>==<a class="code" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a>) {
        <span class="keywordflow">return</span> (<span class="keyword">new</span> <a class="code" href="class_spherical_coordinate_set.html" title="Specialized coordinate set for spherical representation.">SphericalCoordinateSet</a>(*pcset_reduced) );       
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_coordinate_sets.html#ab48f14ec44b28aadfb6729ba5dda7d4c">m_representation</a>==<a class="code" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8a8bcf3ac927052dfa8318c1fb96c4ad10">CYLINDRICAL</a>) {
        <span class="keywordflow">return</span> (<span class="keyword">new</span> <a class="code" href="class_cylindrical_coordinate_set.html" title="Specialized coordinate set for cylindrical representation.">CylindricalCoordinateSet</a>(*pcset_reduced,Params::Inst()-&gt;scattering.average.orientation.axis) );         
    } <span class="keywordflow">else</span> {
        <a class="code" href="class_err.html#a846c4a7446fbd3a2a462fd3a4be006a5">Err::Inst</a>()-&gt;<a class="code" href="class_err.html#abc356b3a463194ecfa4c77c54b0f3547">write</a>(<span class="stringliteral">&quot;CoordinateSets::load: representation not understood&quot;</span>);
        <span class="keywordflow">throw</span>;
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="a6d3e45b120bc3fd1fb47a7d3ba7a8985"></a><!-- doxytag: member="CoordinateSets::serialize" ref="a6d3e45b120bc3fd1fb47a7d3ba7a8985" args="(Archive &amp;ar, const unsigned int version)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Archive &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void CoordinateSets::serialize </td>
          <td>(</td>
          <td class="paramtype">Archive &amp;&#160;</td>
          <td class="paramname"><em>ar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00060">60</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        ar.register_type(static_cast&lt;CoordinateSet*&gt;(NULL));
        ar.register_type(static_cast&lt;Atoms*&gt;(NULL));
        
        ar.register_type(static_cast&lt;LinearMotionWalker*&gt;(NULL));
        ar.register_type(static_cast&lt;RandomMotionWalker*&gt;(NULL));
        ar.register_type(static_cast&lt;FixedMotionWalker*&gt;(NULL));
        ar.register_type(static_cast&lt;OscillationMotionWalker*&gt;(NULL));
        ar.register_type(static_cast&lt;BrownianMotionWalker*&gt;(NULL));
        ar.register_type(static_cast&lt;LocalBrownianMotionWalker*&gt;(NULL));
        
        <span class="comment">// ar &amp; m_prealignmentvectors;</span>
        <span class="comment">// ar &amp; m_postalignmentvectors;</span>

        ar &amp; <a class="code" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">m_motion_walkers</a>;
        ar &amp; <a class="code" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">m_prealignments</a>;
        ar &amp; <a class="code" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">m_postalignments</a>;

        ar &amp; <a class="code" href="class_coordinate_sets.html#a3a20f359374d6b852b0f319ff612f871">frames</a>;

        <span class="comment">// DONT set back references. have to be set from the outside</span>
        <span class="comment">// p_atoms;</span>
        <span class="comment">// p_selection;</span>

        ar &amp; <a class="code" href="class_coordinate_sets.html#ab48f14ec44b28aadfb6729ba5dda7d4c">m_representation</a>;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a4fa6b50f55869ceebaf8ab866b3acc1a"></a><!-- doxytag: member="CoordinateSets::set_atoms" ref="a4fa6b50f55869ceebaf8ab866b3acc1a" args="(Atoms &amp;atoms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoordinateSets::set_atoms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_atoms.html">Atoms</a> &amp;&#160;</td>
          <td class="paramname"><em>atoms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00195">195</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                           {
    <a class="code" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">p_atoms</a> = &amp;atoms;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8957228f5097d59409164c46d0cb012a"></a><!-- doxytag: member="CoordinateSets::set_representation" ref="a8957228f5097d59409164c46d0cb012a" args="(CoordinateRepresentation representation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoordinateSets::set_representation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8">CoordinateRepresentation</a>&#160;</td>
          <td class="paramname"><em>representation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00187">187</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                                               {
    <a class="code" href="class_coordinate_sets.html#ab48f14ec44b28aadfb6729ba5dda7d4c">m_representation</a> = representation;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a687990ee78dae83628564f22250836d1"></a><!-- doxytag: member="CoordinateSets::set_selection" ref="a687990ee78dae83628564f22250836d1" args="(IAtomselection *selection)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoordinateSets::set_selection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_i_atomselection.html">IAtomselection</a> *&#160;</td>
          <td class="paramname"><em>selection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00308">308</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                            {
    <a class="code" href="class_coordinate_sets.html#a673223c4767d42faafcf2cf234aa80ed">p_selection</a> = selection;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac7b9aefaa1506fb01916e38b18e851f6"></a><!-- doxytag: member="CoordinateSets::size" ref="ac7b9aefaa1506fb01916e38b18e851f6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CoordinateSets::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00125">125</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_coordinate_sets.html#a3a20f359374d6b852b0f319ff612f871">frames</a>.<a class="code" href="class_frames.html#a6a52d9ecb3b0fed8455c8ce02e9226db">size</a>(); }
</pre></div>
</div>
</div>
<a class="anchor" id="a9e0021d7721820394fef2d4ca44895bf"></a><!-- doxytag: member="CoordinateSets::write_xyz" ref="a9e0021d7721820394fef2d4ca44895bf" args="(std::string filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoordinateSets::write_xyz </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8cpp_source.html#l00293">293</a> of file <a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                 {
    ofstream ofile(filename.c_str());
    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="class_coordinate_sets.html#ac7b9aefaa1506fb01916e38b18e851f6">size</a>(); ++i) {
        <a class="code" href="class_coordinate_set.html" title="A set of coordinates with an associated representation.">CoordinateSet</a>* pcset = <a class="code" href="class_coordinate_sets.html#ac85efa8a6d7438a07ce3d41a8eb1100f">load</a>(i);
        ofile &lt;&lt; pcset-&gt;<a class="code" href="class_coordinate_set.html#a1ffa1a198ee81d3ed61bb52cae5f75a0">size</a>() &lt;&lt; endl;
        ofile &lt;&lt; <span class="stringliteral">&quot;generated by s_coordump&quot;</span> &lt;&lt; endl;
        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; pcset-&gt;<a class="code" href="class_coordinate_set.html#a1ffa1a198ee81d3ed61bb52cae5f75a0">size</a>(); ++j)
        {
            ofile &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pcset-&gt;<a class="code" href="class_coordinate_set.html#a9779b8963cbe85bbadea1d591843346c">c1</a>[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pcset-&gt;<a class="code" href="class_coordinate_set.html#a9feb5f09ef294aec973250ce5ba10de6">c2</a>[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pcset-&gt;<a class="code" href="class_coordinate_set.html#aae9725d5ca213cb016fa2ad04c1d07f8">c3</a>[j] &lt;&lt; endl;
        }
        <span class="keyword">delete</span> pcset;
    }
    ofile.close();
}
</pre></div>
</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="ac98d07dd8f7b70e16ccb9a01abf56b9c"></a><!-- doxytag: member="CoordinateSets::boost::serialization::access" ref="ac98d07dd8f7b70e16ccb9a01abf56b9c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class boost::serialization::access<code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00059">59</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a3a20f359374d6b852b0f319ff612f871"></a><!-- doxytag: member="CoordinateSets::frames" ref="a3a20f359374d6b852b0f319ff612f871" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_frames.html">Frames</a> <a class="el" href="class_coordinate_sets.html#a3a20f359374d6b852b0f319ff612f871">CoordinateSets::frames</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00095">95</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="acc70cc66a81ab9c20fc2da714a403093"></a><!-- doxytag: member="CoordinateSets::m_motion_walkers" ref="acc70cc66a81ab9c20fc2da714a403093" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt;std::string,<a class="el" href="class_motion_walker.html">MotionWalker</a>*&gt; &gt; <a class="el" href="class_coordinate_sets.html#acc70cc66a81ab9c20fc2da714a403093">CoordinateSets::m_motion_walkers</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00091">91</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a10586db54a84b76ff5bc93b1ca28354f"></a><!-- doxytag: member="CoordinateSets::m_postalignments" ref="a10586db54a84b76ff5bc93b1ca28354f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="class_coordinate_set_alignment.html">CoordinateSetAlignment</a> &gt; <a class="el" href="class_coordinate_sets.html#a10586db54a84b76ff5bc93b1ca28354f">CoordinateSets::m_postalignments</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00093">93</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a729f6067e04181ee9d808b3974955203"></a><!-- doxytag: member="CoordinateSets::m_prealignments" ref="a729f6067e04181ee9d808b3974955203" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="class_coordinate_set_alignment.html">CoordinateSetAlignment</a> &gt; <a class="el" href="class_coordinate_sets.html#a729f6067e04181ee9d808b3974955203">CoordinateSets::m_prealignments</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00092">92</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab48f14ec44b28aadfb6729ba5dda7d4c"></a><!-- doxytag: member="CoordinateSets::m_representation" ref="ab48f14ec44b28aadfb6729ba5dda7d4c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="coordinate__set_8hpp.html#a852a4456bfb79f5b8df21a570c7eeff8">CoordinateRepresentation</a> <a class="el" href="class_coordinate_sets.html#ab48f14ec44b28aadfb6729ba5dda7d4c">CoordinateSets::m_representation</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00100">100</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9665dba87f11fca9a253504b6b87984b"></a><!-- doxytag: member="CoordinateSets::p_atoms" ref="a9665dba87f11fca9a253504b6b87984b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_atoms.html">Atoms</a>* <a class="el" href="class_coordinate_sets.html#a9665dba87f11fca9a253504b6b87984b">CoordinateSets::p_atoms</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00097">97</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a673223c4767d42faafcf2cf234aa80ed"></a><!-- doxytag: member="CoordinateSets::p_selection" ref="a673223c4767d42faafcf2cf234aa80ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_i_atomselection.html">IAtomselection</a>* <a class="el" href="class_coordinate_sets.html#a673223c4767d42faafcf2cf234aa80ed">CoordinateSets::p_selection</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="coordinate__sets_8hpp_source.html#l00098">98</a> of file <a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="coordinate__sets_8hpp_source.html">coordinate_sets.hpp</a></li>
<li><a class="el" href="coordinate__sets_8cpp_source.html">coordinate_sets.cpp</a></li>
</ul>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 7 2012 20:58:54 for Sassena by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
